> 키-값 저장소 설계

키-값 저장소 : 비 관계형 데이터베이스

- 고유 식별자를 키로 가져야 함 (일반 텍스트, 해시 가능)
    - 짧을 수록 좋음

- 가용성 : 장애가 있더라도 빨리 응답해야함
- 규모 확장성 : 트래픽 양에 따라 자동적으로 서버 증설/삭제

- 규모에 따른 키-값 저장소 방안
    1. 키-값 쌍 전부를 메모리에 해시 테이블로 저장
    - 빠른 속도를 보장하긴 하지만 모든 데이터를 메모리 안에 두는 것이 불가능 할 수도 있음
        - → 데이터 압축
        - → 자주 쓰는 데이터만 메모리에 두고 나머지는 디스크에 저장
    1. 분산 키-값 저장소 (=분산 해시 테이블)
    - CAP 정리 (Consistency, Availability, Parition Tolerance theorem(파티션 감내))

      : 세 가지 요구사항을 동시에 만족하는 분산 시스템을 설계하는 것은 불가능 하다는 정리

        - 데이터 일관성 : 분산 시스템에 접속하는 모든 클라이언트는 어떤 노드에 접속했느냐에 관계없이 언제나 같은 데이터를 보게 되어야 함
        - 가용성 : 분산 시스템에 접속하는 클라이언트는 일부 노드에 장애가 발생하더라도 항상 응답을 받을 수 있어야 함
        - 파티션 감내 :  파티션은 두 노드 사이에 통신 장애가 발생하였음을 의미. 네트워크에 파티션이 생기더라도 시스템은 계속 동작해야 함

      ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/4eb17d17-9fd9-456b-9cd6-805a7036e822/c40bda91-5a6a-42ef-98e9-2a37fc5949aa/Untitled.png)

      ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/4eb17d17-9fd9-456b-9cd6-805a7036e822/d7fd1c8f-947b-4228-ae56-7876c8821345/Untitled.png)

        - CP : 가용성 희생
        - AP : 데이터 일관성 희생
        - CA : 통상 네트워크 장애는 피할 수 없는 일.  분산 시스템은 **반드시 파티션 문제를 감내할 수 있도록 설계 되어야 함 (→ 실세계에 존재하지 않음)**
- 데이터 파티션
    - 고려사항
        - 데이터를 여러 서버에 고르게 분산할 수 있는가
        - 노드가 추가/삭제될 때 데이터의 이동을 최소화할 수 있는가